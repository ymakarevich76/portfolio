'use strict';

new WOW().init();
var buttons = document.querySelectorAll('button');

if (buttons) {
  for (var i = 0; i < buttons.length; i++) {
    buttons[i].addEventListener('mouseup', function () {
      this.blur();
    });
  }
}

var popularSlider = new Swiper('.popular-slider', {
  // loop: true,
  // effect: "fade",
  navigation: {
    nextEl: '.popular-slider__btn-next',
    prevEl: '.popular-slider__btn-prev'
  },
  slidesPerView: 3,
  spaceBetween: 20,
  breakpoints: {
    320: {
      slidesPerView: 1
    },
    768: {
      slidesPerView: 2
    },
    1075: {
      slidesPerView: 3
    }
  }
});
var seasonSlider = new Swiper('.season-slider', {
  navigation: {
    nextEl: '.season-slider__btn-next',
    prevEl: '.season-slider__btn-prev'
  },
  slidesPerView: 3,
  spaceBetween: 20,
  breakpoints: {
    320: {
      slidesPerView: 1
    },
    768: {
      slidesPerView: 2
    },
    1075: {
      slidesPerView: 3
    }
  }
});

if (document.querySelector('.promo')) {
  var promo = document.querySelector('.promo');
  var header = document.querySelector('.header');
  var headerXl = document.querySelector('.header-xl');
  window.addEventListener('scroll', function () {
    console.log(pageYOffset);

    if (pageYOffset >= 200) {
      promo.classList.add('promo--absolute');
    } else {
      promo.classList.remove('promo--absolute');
    }

    ;

    if (pageYOffset >= 200) {
      header.classList.add('header--dark');
      headerXl.classList.add('header--dark');
    } else {
      header.classList.remove('header--dark');
      headerXl.classList.remove('header--dark');
    } // if (pageYOffset >= 1900) {
    //   header.classList.remove('header--dark');
    //   header.classList.add('header--light')
    // }

  });
}

if (document.querySelector('.preloader')) {
  var preloader = document.querySelector('.preloader');
  window.addEventListener("load", function () {
    setTimeout(function () {
      preloader.classList.add('preloader--hidden');
    }, 3000);
  });
}

var popupLinks = document.querySelectorAll('.popup__link');
var body = document.querySelector('body');

var popupOpen = function popupOpen(currentPopup) {
  if (currentPopup) {
    var popupActive = document.querySelector('.popup--open');

    if (popupActive) {
      popupClose(popupActive);
    }
  }

  body.classList.add('fixed');
  currentPopup.classList.add('popup--open');
  currentPopup.addEventListener('click', function (e) {
    if (!e.target.closest('.popup__content')) {
      popupClose(e.target.closest('.popup'));
    }
  });
};

var popupClose = function popupClose(currentPopup) {
  currentPopup.classList.remove('popup--open');
  body.classList.remove('fixed');
};

var closeIcons = document.querySelectorAll('.popup__close');
closeIcons.forEach(function (close) {
  close.addEventListener('click', function () {
    popupClose(close.closest('.popup'));
  });
});
document.addEventListener('keydown', function (e) {
  if (e.which === 27) {
    var popupActive = document.querySelector('.popup--open');
    popupClose(popupActive);
  }
});

if (popupLinks.length > 0) {
  popupLinks.forEach(function (popupLink, index) {
    popupLink.addEventListener('click', function (e) {
      var currentPopup = document.getElementById('popup-order');
      popupOpen(currentPopup);
      e.preventDefault();
    });
  });
}

var hamburger = document.querySelector('.header__wrap-icon');
var nav = document.querySelector('.header-blur');

var openMenu = function openMenu() {
  body.classList.add('fixed');
  nav.classList.add('header-blur--active');
};

var closeMenu = function closeMenu() {
  body.classList.remove('fixed');
  nav.classList.remove('header-blur--active');
};

hamburger.addEventListener('click', function () {
  if (hamburger.classList.contains('header__wrap-icon--close')) {
    closeMenu();
    hamburger.classList.remove('header__wrap-icon--close');
  } else {
    openMenu();
    hamburger.classList.add('header__wrap-icon--close');
  }
});
nav.addEventListener('click', function (evt) {
  if (evt.target === nav) {
    closeMenu();
    hamburger.classList.remove('header__wrap-icon--close');
  }
});
var mediaQuery = window.matchMedia('(max-width: 1085px)');

var handleTabletChange = function handleTabletChange(e) {
  if (e.matches) {
    var _header = document.querySelector('.header');

    var animates = _header.querySelectorAll('.animate__animated');

    animates.forEach(function (animate) {
      animate.classList.remove("animate__animated");
    });
  }
};

mediaQuery.addListener(handleTabletChange);
handleTabletChange(mediaQuery);
$("#phone_1").mask("+7(999) 999-9999");
$("#center_ok").click(function () {
  $(this).setCursorPosition(3);
}).mask("+7(999) 999-9999");
$("#center_not_ok").mask("+7(999) 999-9999");

if (document.querySelector(".form__checkbox-input")) {
  var chbox = document.querySelector(".form__checkbox-input");
  var btn = document.querySelector(".popup__btn");
  chbox.addEventListener('change', function () {
    if (btn.hasAttribute("disabled")) {
      btn.removeAttribute("disabled");
    } else {
      btn.setAttribute("disabled", "disabled");
    }
  });
}